// ARGS: --dump-ir
// EXPECTED_OUTPUT: <function: foo> (params: 0, slots: 1)
// EXPECTED_OUTPUT: STRUCT_ALLOC        slots 2
// EXPECTED_OUTPUT: STORE_VAR           slot 0
// EXPECTED_OUTPUT: PUSH_I32            30
// EXPECTED_OUTPUT: LOAD_VAR            slot 0
// EXPECTED_OUTPUT: STORE_PTR_OFFSET    offset 0
// EXPECTED_OUTPUT: PUSH_I32            40
// EXPECTED_OUTPUT: LOAD_VAR            slot 0
// EXPECTED_OUTPUT: STORE_PTR_OFFSET    offset 1
// EXPECTED_OUTPUT: LOAD_VAR            slot 0
// EXPECTED_OUTPUT: RET                
// EXPECTED_OUTPUT: <function: main> (params: 0, slots: 1)
// EXPECTED_OUTPUT: CALL                addr 25 args 0 <foo>
// EXPECTED_OUTPUT: STORE_VAR           slot 0
// EXPECTED_OUTPUT: LOAD_VAR            slot 0
// EXPECTED_OUTPUT: CALL                addr 63 args 1 <foo2>
#include "std/io.eth"

struct Point {
    i32 x;
    i32 y;
}

Point foo() {
    Point p;
    p.x = 30;
    p.y = 40;
    return p;
}

void foo2(Point p) {
    printf("foo2: %d, %d\n", p.x, p.y);
}

i32 main() {
    Point p = foo();
    foo2(p);
    return p.x + p.y;
}
