// EXPECTED_OUTPUT: Starting coroutines...
// EXPECTED_OUTPUT: Worker 5: loop 0
// EXPECTED_OUTPUT: Worker 4: loop 0
// EXPECTED_OUTPUT: Worker 3: loop 0
// EXPECTED_OUTPUT: Worker 2: loop 0
// EXPECTED_OUTPUT: Worker 1: loop 0
// EXPECTED_OUTPUT: Main finished spawning.
// EXPECTED_OUTPUT: Worker 5: loop 1
// EXPECTED_OUTPUT: Worker 4: loop 1
// EXPECTED_OUTPUT: Worker 3: loop 1
// EXPECTED_OUTPUT: Worker 2: loop 1
// EXPECTED_OUTPUT: Worker 5: loop 2
// EXPECTED_OUTPUT: Worker 4: loop 2
// EXPECTED_OUTPUT: Worker 3: loop 2
// EXPECTED_OUTPUT: Worker 5: loop 3
// EXPECTED_OUTPUT: Worker 4: loop 3
// EXPECTED_OUTPUT: Worker 5: loop 4
// EXPECTED_RESULT: 0
#include "std/io.eth"

i32 worker(i32 id, i32 count) {
    for (i32 i = 0; i < count; i++) {
        printf("Worker %d: loop %d\n", id, i);
        yield;
    }
}

i32 main() {
    printf("Starting coroutines...\n");
    i32 count = 5;
    for (i32 i = count; i >= 1; i--) {
        spawn worker(i, i);
    }
    printf("Main finished spawning.\n");
    return 0;
}
